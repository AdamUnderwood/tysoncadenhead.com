<!DOCTYPE html>
<!--[if IE 6]>
    <html id="ie6" lang="en-US">
<![endif]-->
<!--[if IE 7]>
    <html id="ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
    <html id="ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 6) | !(IE 7) | !(IE 8)  ]><!-->
    <html lang="en-US">
<!--<![endif]-->
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta name="google-site-verification" content="AeV4w7EOhEv3lU1OT8KOM7jRS0C6jDAsZyMaG38t1g4" />
        <meta property="og:image" content="http://www.tysoncadenhead.com/images/blog/how-to-abstract-pub-sub-in-your-application.jpg"/>
        <meta property="og:title" content="How To Abstract Pub / Sub Methods In Your Application"/>
        <meta property="og:url" content="http://www.tysoncadenhead.com"/>
        <meta property="og:site_name" content="Tyson Cadenhead"/>
        <meta property="og:description" content="Thoughts on productivity, web apps and JavaScript" />
        <title>How To Abstract Pub / Sub Methods In Your Application</title>
        <link rel="shortcut icon" href="/images/favicon.ico" /> 
        <link rel="stylesheet" href="/css/app.css" />
        <link rel="alternate" type="application/rss+xml" title="How To Abstract Pub / Sub Methods In Your Application Thoughts on productivity, web apps and JavaScript" href="http://www.tysoncadenhead.com/feed.xml" />
    </head>
    <body>
        <script type="text/javascript">

          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-19696495-1']);
          _gaq.push(['_trackPageview']);
        
          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
        
        </script>
        <div id="fb-root"></div>
        <div class="header" id="top">
            <div class="container">
                <div class="span12">
                    <div class="span4 left">
                        <h1 id="logo"><a href="/"><img src="/images/logo.png" /></a></h1>
                    </div>
                    <div class="span6 right">
                        <div class="navbar navbar-inverse">
                            <div class="navbar-inner right">
                                <ul class="nav right">
                                  <li><a href="/">Blog</a></li>
                                  <li><a href="/presentations">Presentations</a></li>
                                  <li><a href="/about">About Me</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="span12">
                
                    
                    
                        
                        <article>

    <div class="well span2 right thumbnail">
      <img src="/images/blog/how-to-abstract-pub-sub-in-your-application.jpg" />
    </div>

    <h1>How To Abstract Pub / Sub Methods In Your Application</h1>

    

    <h5><span class="label label-info"><a href="/?category=code">code</a></span> | 3-18-2014</h5>

    <p>If you have worked on a large scalable web application, I probably don&#39;t have to tell you how important it is to keep your modules from directly referencing each other. There are several Pub/Sub libraries that have emerged to solve that problem. Some of the main contenders are <a href="https://github.com/mroderick/PubSubJS">PubSubJS</a>, <a href="https://github.com/postaljs/postal.js">Postal</a> and <a href="http://amplifyjs.com/">Amplify</a>.</p>
<p>With several options to chose from, there is certainly value in abstracting away whichever choice you make so that you could easily switch the Pub/Sub library out without impacting the application. There are various reasons for switching libraries. Your library of choice might become unmaintained, or perhaps it will evolve in a way that doesn&#39;t suite your needs, or perhaps a better solution will emerge. Whatever the case, you certainly don&#39;t want to be locked in and have to change every file of your application if you do make the choice to switch at some point. Additionally, if you are using an AMD loader, you get the added benefit of not needing to require the pub/sub library in every module that uses it. This is how I have gone about abstracting my pub/sub libraries in applications in the past.</p>
<!-- more -->

<h3>Create a Pub/Sub Mixin</h3>
<p>I would start by creating a mixin to use with my classes. This is basically just an object that extends methods to publish and subscribe to topics. Your methods might look something like this:</p>
<pre><code class="language-js">var PubSubMixin = {

    publish: function (topic, data) {

    },

    subscribe: function (topic, callback) {

    },

    unsubscribe: function (topic) {

    },

    unsubscribeAll: function () {

    }

}</code></pre>
<p>To flesh this out, the mixin might look something like this if we are using Postal:</p>
<pre><code class="language-js">var PubSubMixin = {

    _subscriptions: {},

    publish: function (topic, data) {
        postal.publish({
            topic: topic,
            data: data
        });
    },

    subscribe: function (topic, callback) {
        this._subscriptions[topic] = postal.subscribe({
            topic: topic,
            callback: callback.bind(this)
        });
    },

    unsubscribe: function (topic) {
        this._subscriptions[topic].unsubscribe();
        delete this._subscriptions[topic];
    },

    unsubscribeAll: function () {
        var self = this;
        for (var subscription in this._subscriptions) {
            this.unsubscribe(subscription);
        }
    }

}</code></pre>
<p>I basically just save a reference to all of the subscriptions in the <code>_subscriptions</code> object so that I can use the references to unsubscribe from any of the topics if I need to.</p>
<h3>Mix the Mixin Into Your Classes</h3>
<p>I typically don&#39;t just use the classes that my MV* framework gives me out of the box. Instead, I wrap them up so that I can extend them and add functionality for all of my modules.</p>
<p>For example, instead of just extending Backbone&#39;s View, I might have an abstraction like this:</p>
<pre><code class="language-js">myApp.View = function (options) {

    return Backbone.View.extend(
        _.extend(options, PubSubMixin)
    );

};</code></pre>
<h3>New Up Your Classes and Enjoy Pub / Sub</h3>
<p>With the backbone view abstraction using my PubSubMixin, I can call the <code>this.publish()</code>and <code>this.subscribe()</code> methods where I need them.</p>
<pre><code class="language-js">var documentRow = new myApp.View({

    initialize: function () {

        this.publish(&#39;document-rendered&#39;, {
            rendered: true
        });

        this.subscribe(&#39;some-subscription&#39;, function (data) {
            console.log(data);
        });

    }

});</code></pre>
<p>While this example uses Backbone, it works just as well with most of the other popular frameworks. It is a great way to abstract your pub / sub calls so that you can use them when you need them to communicate messages across your application.</p>


    <h5>Tags: 
    
        <span class="label">
            <a href="/?tag=javascript">javascript</a>
        </span>
    
        <span class="label">
            <a href="/?tag=pubsub">pubsub</a>
        </span>
    
    </h5>

    <br />

    <div class="google-things">

        <style>
        .responsive-unit { width: 320px; height: 50px; }
        @media(min-width: 500px) { .responsive-unit { width: 468px; height: 60px; } }
        @media(min-width: 800px) { .responsive-unit { width: 728px; height: 90px; } }
        </style>
        <script async src="http://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
        <!-- Responsive unit -->
        <ins class="adsbygoogle responsive-unit"
             style="display:inline-block"
             data-ad-client="ca-pub-5130799763611680"
             data-ad-slot="1789954798"></ins>
        <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
        </script>

    </div>

    <br />

    <!--
    <h4>Related Posts:</h4>
    <div id="related-posts" class="clear">
        <div class="well left thumbnail"></div>
        <div class="well left thumbnail"></div>
        <div class="well left thumbnail"></div>
    </div>
    -->

</article>

<div class="share">
    <div class="addthis_toolbox addthis_default_style addthis_32x32_style">
        <a class="addthis_button_preferred_1"></a>
        <a class="addthis_button_preferred_2"></a>
        <a class="addthis_button_preferred_3"></a>
        <a class="addthis_button_preferred_4"></a>
        <a class="addthis_button_compact"></a>
        <a class="addthis_counter addthis_bubble_style"></a>
    </div>
</div>

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'tysoncadenhead'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                    
                
            </div>
        </div>
        <script data-main="/js/app.js" src="/js/vendor/require.js"></script>
        <div class="footer">
                <div class="container">
                    <div class="addthis_default_style span12 addthis_32x32_style">
                        <a class="addthis_button_facebook_follow" addthis:userid="tysoncadenhead"></a>
                        <a class="addthis_button_twitter_follow" addthis:userid="tysoncadenhead"></a>
                        <a class="addthis_button_linkedin_follow" addthis:userid="tysoncadenhead"></a>
                        <a class="addthis_button_google_follow" addthis:userid="tysoncadenhead"></a>
                        <a class="addthis_button_youtube_follow" addthis:userid="tysoncadenhead"></a>
                        <a class="addthis_button_flickr_follow" addthis:userid="tysonlloydcadenhead"></a>
                        <a class="addthis_button_instagram_follow" addthis:userid="112101485541389007178"></a>
                    </div>
                    <div class="span12" id="twitter-feed">
                        <a class="twitter-timeline" href="https://twitter.com/tysoncadenhead" data-widget-id="377141114454564864">Tweets by @tysoncadenhead</a>
                        <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
                        <script type="text/javascript">
                            window.tysonJS = {
                                slug: ''
                            };
                        </script>
                    </div>
                </div>
        </div>
    </body>
</html>