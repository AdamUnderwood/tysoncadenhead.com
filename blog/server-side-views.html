<!DOCTYPE html>
<!--[if IE 6]>
    <html id="ie6" lang="en-US">
<![endif]-->
<!--[if IE 7]>
    <html id="ie7" lang="en-US">
<![endif]-->
<!--[if IE 8]>
    <html id="ie8" lang="en-US">
<![endif]-->
<!--[if !(IE 6) | !(IE 7) | !(IE 8)  ]><!-->
    <html lang="en-US">
<!--<![endif]-->
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=400, initial-scale=0.5">
        <meta name="google-site-verification" content="AeV4w7EOhEv3lU1OT8KOM7jRS0C6jDAsZyMaG38t1g4" />
        <meta property="og:image" content="http://www.tysoncadenhead.com/images/blog/server-side-views.png"/>
        <meta property="og:title" content="Sails Server-Side Views"/>
        <meta property="og:url" content="http://www.tysoncadenhead.com"/>
        <meta property="og:site_name" content="Tyson Cadenhead"/>
        <meta property="og:description" content="Thoughts on productivity, web apps and JavaScript" />
        <title>Sails Server-Side Views</title>
        <link rel="shortcut icon" href="/images/favicon.ico" /> 
        <link rel="stylesheet" href="/css/app.css" />
        <link rel="alternate" type="application/rss+xml" title="Sails Server-Side Views Thoughts on productivity, web apps and JavaScript" href="http://www.tysoncadenhead.com/feed.xml" />
        
    </head>
    <body>
        <script type="text/javascript">

          var _gaq = _gaq || [];
          _gaq.push(['_setAccount', 'UA-19696495-1']);
          _gaq.push(['_trackPageview']);
        
          (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
          })();
        
        </script>
        <div id="fb-root"></div>
        <div class="header" id="top">
            <div class="container">
                <div class="span12">
                    <div class="span4 left">
                        <h1 id="logo"><a href="/"><img src="/images/logo.png" /></a></h1>
                    </div>
                    <div class="span6 right">
                        <div class="navbar navbar-inverse">
                            <div class="navbar-inner right">
                                <ul class="nav right">
                                  <li><a href="/">Blog</a></li>
                                  <li><a href="/presentations">Presentations</a></li>
                                  <li><a href="/about">About Me</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="container">
            <div class="span12">
                
                    
                    
                        
                        <article>

    <div class="well span2 right thumbnail">
      <img src="/images/blog/server-side-views.png" />
    </div>

    <h1>Sails Server-Side Views</h1>

    
      <h4>
        Creating An Application With Sails, Angular and Require.js (part 3)
      </h4>
    

    <h5><span class="label label-info"><a href="/?category=code">code</a></span> | 5-21-2014</h5>

    <div class="series-placement">

    This is part 3 of the <a href="/blog/sails-ninja-intro">Creating An Application With Sails, Angular and Require.js</a> blog series. If you haven&#39;t read the introduction yet, you may want to start there.

    <h4><a href="/blog/starting_the_sails_project">Previous Post In This Series</a> | <a href="/blog/adding-dependencies">Next Post In This Series</a></h4> 

</div>

<p>Today, we are going to look at how Sails.js handles server-side templating. Sails lets you use whatever type of templating you want want, but out of the box, it uses EJS, which is based off of Ruby&#39;s ERB.</p>
<!-- more -->

<p>Lets start by going into our project directory and starting our server using:</p>
<pre><code class="language-bash">sails lift</code></pre>
<p>All of the views will be served from the <code>/views</code> directory. If you go to localhost:1337, you can see that there is already a template that comes with Sails. That template can be found in <code>views/home/index.ejs</code>. The individual pages are all wrapped with a layout template as well. The layout is located in <code>/views/layout.ejs</code>.</p>
<h3>The Layout</h3>
<p>Let&#39;s replace the layout with our own markup:</p>
<pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
  &lt;head&gt;
    &lt;title&gt;&lt;%- title %&gt; | TODOIT&lt;/title&gt;
    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1, maximum-scale=1&quot; /&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css&quot;&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;//netdna.bootstrapcdn.com/font-awesome/4.1.0/css/font-awesome.min.css&quot;&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;/styles/app.css&quot;&gt;
  &lt;/head&gt;

  &lt;body&gt;
    &lt;div class=&quot;navbar navbar-inverse navbar-fixed-top&quot; role=&quot;navigation&quot;&gt;
      &lt;div class=&quot;container&quot;&gt;
        &lt;div class=&quot;navbar-header&quot;&gt;
          &lt;button type=&quot;button&quot; class=&quot;navbar-toggle&quot; data-toggle=&quot;collapse&quot; data-target=&quot;.navbar-collapse&quot;&gt;
            &lt;span class=&quot;sr-only&quot;&gt;Toggle navigation&lt;/span&gt;
            &lt;span class=&quot;icon-bar&quot;&gt;&lt;/span&gt;
            &lt;span class=&quot;icon-bar&quot;&gt;&lt;/span&gt;
            &lt;span class=&quot;icon-bar&quot;&gt;&lt;/span&gt;
          &lt;/button&gt;
          &lt;a class=&quot;navbar-brand&quot; href=&quot;#&quot;&gt;&lt;i class=&quot;fa fa-check&quot;&gt;&lt;/i&gt; TODOIT&lt;/a&gt;
        &lt;/div&gt;
        &lt;div class=&quot;collapse navbar-collapse&quot;&gt;
          &lt;ul class=&quot;nav navbar-nav&quot;&gt;
            &lt;li class=&quot;active&quot;&gt;&lt;a href=&quot;/&quot;&gt;Home&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a href=&quot;/about&quot;&gt;About&lt;/a&gt;&lt;/li&gt;
            &lt;li&gt;&lt;a href=&quot;/list&quot;&gt;My List&lt;/a&gt;&lt;/li&gt;
          &lt;/ul&gt;
        &lt;/div&gt;
      &lt;/div&gt;
    &lt;/div&gt;

    &lt;div class=&quot;container&quot;&gt;
        &lt;div class=&quot;row featurette&quot;&gt;
            &lt;div class=&quot;col-md-7&quot;&gt;
              &lt;h2 class=&quot;featurette-heading&quot;&gt;&lt;%- title %&gt;&lt;/h2&gt;
              &lt;%- body %&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;

    &lt;script type=&quot;text/javascript&quot; src=&quot;/js/socket.io.js&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;text/javascript&quot; src=&quot;/js/sails.io.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;text/javascript&quot; src=&quot;/js/app.js&quot;&gt;&lt;/script&gt;
  &lt;/body&gt;
&lt;/html&gt;</code></pre>
<p>You may notice that we aren&#39;t using RequireJS to load our modules yet. Don&#39;t worry, we&#39;ll be covering that in the future. You may also notice that we are referencing a <code>styles/app.css</code> file, we will need to create that:</p>
<pre><code class="language-css">body {
  padding-top: 50px;
}
.starter-template {
  padding: 40px 15px;
  text-align: center;
}</code></pre>
<p>You will need to restart your server to see the stylesheet show up. I know it is annoying to have to restart your server when you change a style or script, but we&#39;ll be looking at a solution for that soon.</p>
<h3>Home Page</h3>
<p>Now let&#39;s replace the markup in the <code>home/index.ejs</code> file:</p>
<pre><code class="language-html">&lt;p class=&quot;lead&quot;&gt;Check it out. Check it off.&lt;/p&gt;
&lt;img src=&quot;http://cdn2.content.compendiumblog.com/uploads/user/4268c6b6-ce2f-102a-80e3-0015c5f70ec2/aa4211a4-bb44-46d7-8e55-e2bf85cbb4a4/Image/01056b67869d6ad5848d9df376132aa5/questions_to_ask.jpg&quot; /&gt;</code></pre>
<h3>Passing Data To Your Views</h3>
<p>You might notice that in the layout template, we are referencing a <code>&lt;%- title %&gt;</code> attribute. By default, the title will be &quot;Sails&quot;. You can override that globally by creating a config file like this one I made in <code>config/app.js</code> and adding your own appName:</p>
<pre><code class="language-js">module.exports = {
    appName: &#39;TODOIT&#39;
};</code></pre>
<p>If you want a different title on each page, you can also control the title from your controller. If you look at your <code>config/routes.js</code> file, you will see that the <code>/</code> route is currently just rendering a view instead of being driven by a controller. Why don&#39;t we generate a controller to drive the home page?</p>
<pre><code class="language-bash">sails generate controller home</code></pre>
<p>The command above will generate a new empty controller in your <code>api/controllers</code> directory called <code>HomeController.js</code>. We can add a method to the <code>module.exports</code> called &quot;index.&quot;</p>
<pre><code class="language-js">index: function (req, res) {
    res.view(null, {
        title: &#39;Home&#39;
    });
},
...</code></pre>
<p>The first argument in the res.view() method is the template name. If it is a string, a template with that name will be rendered. If it is blank, the controller uses the controller name and the method name to create the path to the view. The second argument is an object of data that the controller is passing into the view. That is where we can add the title.</p>
<p>Now we will need to update the routes to use the home controller instead of just rendering the home view with no controller.</p>
<p>Find this line:</p>
<pre><code class="language-js">&#39;/&#39;: {
    view: &#39;home/index&#39;
}</code></pre>
<p>and change it to:</p>
<pre><code class="language-js">&#39;/&#39;: {
    controller: &#39;HomeController&#39;,
    action: &#39;index&#39;
}</code></pre>
<p>Once you restart your server and go to the home page, you should see the title &quot;Home&quot; displaying correctly. It should look like this:</p>
<p><img src="/images/blog/sails-server-views1.png" alt=""></p>
<h3>About Page</h3>
<p>Now, let&#39;s go ahead and create an about page:</p>
<pre><code class="language-bash">sails generate controller about</code></pre>
<p>In the module.exports for <code>api/controllers/AboutController.js</code>, add this method:</p>
<pre><code class="language-js">index: function (req, res) {
    res.view(null, {
        title: &#39;About&#39;
    });
},
...</code></pre>
<p>Now open your <code>config/routes.js</code> file and add a this route underneath the previously created home page route:</p>
<pre><code class="language-js">&#39;/about&#39;: {
    controller: &#39;AboutController&#39;,
    action: &#39;index&#39;
}</code></pre>
<p>Last of all, we will need to create the view for our about page. We will create a file name <code>/views/about/index.ejs</code> with this markup:</p>
<pre><code class="language-html">&lt;p class=&quot;lead&quot;&gt;This is an example application to show how to use Sails.js with Angular. If you would like to follow along with how it was created, check out this &lt;a href=&quot;http://www.tysoncadenhead.com/blog/sails-ninja-intro&quot;&gt;blog series&lt;/a&gt; that walks you through step by step.&lt;/p&gt;</code></pre>
<p>Now, when you go to localhost:1337/about, you should see this:</p>
<p><img src="/images/blog/sails-server-views2.png" alt=""></p>
<h3>URL Helpers</h3>
<p>Sails ships with just the standard EJS implementation. There are <a href="https://code.google.com/p/embeddedjavascript/wiki/ViewHelpers">some handy helpers</a> that Sails doesn&#39;t take advantage of. Luckily, it&#39;s easy to add them to your app.</p>
<p>First, just install the dependency:</p>
<pre><code class="language-bash">npm install express-helpers --save</code></pre>
<p>and then add this to your <code>config/bootstrap.js</code> file:</p>
<pre><code class="language-js">require(&#39;express-helpers&#39;)(sails.express.app);</code></pre>
<p>With that update in place, we can change the layout.ejs file to use the <code>link_to()</code> helper like this:</p>
<pre><code class="language-html">&lt;ul class=&quot;nav navbar-nav&quot;&gt;
  &lt;li class=&quot;active&quot;&gt;
    &lt;%- link_to(&#39;Home&#39;, &#39;/&#39;) %&gt;
  &lt;/li&gt;
  &lt;li&gt;
    &lt;%- link_to(&#39;About&#39;, &#39;/about&#39;) %&gt;
  &lt;/li&gt;
&lt;/ul&gt;</code></pre>
<p>When you restart your server and refresh the app, it should still display correctly, but it is using the view helpers now.</p>
<h3>Active Section</h3>
<p>Because the controllers are already sending the title to the views, we can use that to determine what page we are on. We&#39;ll apply an &quot;active&quot; class to the page name in the navigation that we are currently on:</p>
<pre><code class="language-html">&lt;ul class=&quot;nav navbar-nav&quot;&gt;
  &lt;li class=&quot;&lt;% if (title === &#39;Home&#39;) { %&gt;active&lt;% } %&gt;&quot;&gt;
    &lt;%- link_to(&#39;Home&#39;, &#39;/&#39;) %&gt;
  &lt;/li&gt;
  &lt;li class=&quot;&lt;% if (title === &#39;About&#39;) { %&gt;active&lt;% } %&gt;&quot;&gt;
    &lt;%- link_to(&#39;About&#39;, &#39;/about&#39;) %&gt;
  &lt;/li&gt;
&lt;/ul&gt;</code></pre>
<p>That is the quick rundown of Sails templates and how they work. If you want to see all of this code together, check out the repository <a href="https://github.com/tysoncadenhead/sails-angular-example-app/tree/07db5eb5457b4cd2209691c5e2c32ea22c54e5f0">at this point</a>.</p>


    <h5>Tags: 
    
        <span class="label">
            <a href="/?tag=sailsjs">sailsjs</a>
        </span>
    
    </h5>

    <br />

    <div class="google-things">

        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
  <ins class="adsbygoogle"
       style="display:block"
       data-ad-client="ca-pub-5130799763611680"
       data-ad-slot="1525472392"
       data-ad-format="auto"></ins>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({});
  </script>

    </div>

    <br />

</article>

<div class="share">
    <div class="addthis_toolbox addthis_default_style addthis_32x32_style">
        <a class="addthis_button_preferred_1"></a>
        <a class="addthis_button_preferred_2"></a>
        <a class="addthis_button_preferred_3"></a>
        <a class="addthis_button_preferred_4"></a>
        <a class="addthis_button_compact"></a>
        <a class="addthis_counter addthis_bubble_style"></a>
    </div>
</div>

<div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'tysoncadenhead';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
                    
                
            </div>
        </div>
        <script data-main="/js/app.js" src="/js/vendor/require.js"></script>
        <div class="footer">
                <div class="container">
                    <div class="addthis_default_style span12 addthis_32x32_style">
                        <a class="addthis_button_facebook_follow" addthis:userid="tysoncadenhead"></a>
                        <a class="addthis_button_twitter_follow" addthis:userid="tysoncadenhead"></a>
                        <a class="addthis_button_linkedin_follow" addthis:userid="tysoncadenhead"></a>
                        <a class="addthis_button_google_follow" addthis:userid="tysoncadenhead"></a>
                        <a class="addthis_button_youtube_follow" addthis:userid="tysoncadenhead"></a>
                        <a href="http://tysoncadenhead.deviantart.com/gallery/" title="Deviant Art" target="_blank" class="deviant-art"></a>
                        <a class="addthis_button_flickr_follow" addthis:userid="tysonlloydcadenhead"></a>
                        <a class="addthis_button_instagram_follow" addthis:userid="tysoncadenhead"></a>
                    </div>
                    <div class="span12" id="twitter-feed">
                        <a class="twitter-timeline" href="https://twitter.com/tysoncadenhead" data-widget-id="377141114454564864">Tweets by @tysoncadenhead</a>
                        <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
                        <script type="text/javascript">
                            window.tysonJS = {
                                slug: ''
                            };
                        </script>
                    </div>
                </div>
        </div>
    </body>
</html>